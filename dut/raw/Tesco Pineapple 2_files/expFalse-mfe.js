var GTM_VERSION="2024-02-20T11:57:28.184Z",cookieBannerAvailable=!1,advCookieTrue=!1,expCookieTrue=!1,expCookieTrue=window.location.search.match(/consumer=(webview|[0-9a-zA-Z-_:]+app)([0-9a-zA-Z-_:]+)?($|&)?/i)||document.cookie.match(/s_app_consumer=(webview|[0-9a-zA-Z-_:]+app)([0-9a-zA-Z-_:]+)?($|;)?/i)?advCookieTrue=cookieBannerAvailable=!0:(cookieBannerAvailable=void 0!==gtmDataLayer.get("cookiePreferences"),advCookieTrue=gtmDataLayer.get("cookiePreferences")&&gtmDataLayer.get("cookiePreferences").advertising,gtmDataLayer.get("cookiePreferences")&&gtmDataLayer.get("cookiePreferences").experience);window._gtm={getCookie:function(cname){for(var name=cname+"=",ca=decodeURIComponent(document.cookie).split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf(name))return c.substring(name.length,c.length)}return""},getQueryParam:function(name){return name=name.replace(/[[]/,"\\[").replace(/[\]]/,"\\]"),null===(name=new RegExp("[\\?&]"+name+"=([^&#]*)").exec(location.search))?null:decodeURIComponent(name[1].replace(/\+/g," "))},setCookie:function(value,cdp,key){},notify:function(description,message){if(description=description||"",message=message||"","1"===_gtm.getCookie("ait_dev"))return console.log(description,message)},sessionStorage:{get:function(item){if(item&&sessionStorage&&"object"==typeof sessionStorage&&sessionStorage.getItem&&sessionStorage.getItem(item))return sessionStorage.getItem(item)},set:function(item,val){},remove:function(item){item&&sessionStorage&&"object"==typeof sessionStorage&&sessionStorage.removeItem&&sessionStorage.getItem(item)&&(sessionStorage.removeItem(item),_gtm.notify("sessionStorage remove: ",item))}},localStorage:{get:function(item){if(item&&localStorage&&"object"==typeof localStorage&&localStorage.getItem&&localStorage.getItem(item))return localStorage.getItem(item)},set:function(item,val){},remove:function(item){item&&localStorage&&"object"==typeof localStorage&&localStorage.removeItem&&localStorage.getItem(item)&&(localStorage.removeItem(item),_gtm.notify("localStorage removed: ",item))}},triggerCustomEvent:function(evnt){var evt;~navigator.userAgent.indexOf("MSIE")||~navigator.userAgent.indexOf("Trident/")?((evt=window.createEvent("Event")).initEvent(evnt,!0,!0),window.dispatchEvent(evt)):window.dispatchEvent(new Event(evnt))},debouncer:function(f,_to){var t_o,to;if("function"==typeof f)return to=_to||250,function(){var context=this,args=arguments;clearTimeout(t_o),t_o=setTimeout(function(){t_o=null,f.apply(context,args)},to)};_gtm.notify("TypeError handling yy_debouncer: f must be a function and _to must be an int")},throttle:function(f,timeout){var throttle=!1;return function(){throttle||(f.apply(this,arguments),throttle=!0,setTimeout(function(){throttle=!1},timeout))}},injectSha256:function(){window.SHA256&&window.SHA256.hash||(window.SHA256=window.SHA256||{},window.SHA256.K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],window.SHA256.Uint8Array=function(e){return new("undefined"!=typeof Uint8Array?Uint8Array:Array)(e)},window.SHA256.Int32Array=function(e){return new("undefined"!=typeof Int32Array?Int32Array:Array)(e)},window.SHA256.setArray=function(e,o){if("undefined"!=typeof Uint8Array)e.set(o);else{for(var t=0;t<o.length;t++)e[t]=o[t];for(t=o.length;t<e.length;t++)e[t]=0}},window.SHA256.digest=function(e){var o=1779033703,t=3144134277,n=1013904242,i=2773480762,a=1359893119,r=2600822924,s=528734635,c=1541459225,p=window.SHA256.K;if("string"==typeof e){var d=unescape(encodeURIComponent(e));e=window.SHA256.Uint8Array(d.length);for(var l=0;l<d.length;l++)e[l]=255&d.charCodeAt(l)}var O=e.length,h=64*Math.floor((O+72)/64),m=h/4,u=8*O,w=window.SHA256.Uint8Array(h),f=(window.SHA256.setArray(w,e),w[O]=128,w[h-4]=u>>>24,w[h-3]=u>>>16&255,w[h-2]=u>>>8&255,w[h-1]=255&u,window.SHA256.Int32Array(m)),v=0;for(l=0;l<f.length;l++){var y=w[v]<<24,y=(y=(y|=w[v+1]<<16)|w[v+2]<<8)|w[v+3];f[l]=y,v+=4}for(var g=window.SHA256.Int32Array(64),b=0;b<m;b+=16){for(l=0;l<16;l++)g[l]=f[b+l];for(l=16;l<64;l++){var _=g[l-15],k=(k=_>>>7|_<<25)^(_>>>18|_<<14)^_>>>3,C=(C=(_=g[l-2])>>>17|_<<15)^(_>>>19|_<<13)^_>>>10;g[l]=g[l-16]+k+g[l-7]+C&4294967295}for(var S=o,P=t,E=n,x=i,I=a,T=r,L=s,D=c,l=0;l<64;l++)var M=D+(C=(C=I>>>6|I<<26)^(I>>>11|I<<21)^(I>>>25|I<<7))+(I&T^~I&L)+p[l]+g[l]&4294967295,A=S&P^S&E^P&E,D=L,L=T,T=I,I=x+M&4294967295,x=E,E=P,P=S,S=M+((k=(k=S>>>2|S<<30)^(S>>>13|S<<19)^(S>>>22|S<<10))+A&4294967295)&4294967295;o=o+S&4294967295,t=t+P&4294967295,n=n+E&4294967295,i=i+x&4294967295,a=a+I&4294967295,r=r+T&4294967295,s=s+L&4294967295,c=c+D&4294967295}var N=window.SHA256.Uint8Array(32);for(l=0;l<4;l++)N[l]=o>>>8*(3-l)&255,N[l+4]=t>>>8*(3-l)&255,N[l+8]=n>>>8*(3-l)&255,N[l+12]=i>>>8*(3-l)&255,N[l+16]=a>>>8*(3-l)&255,N[l+20]=r>>>8*(3-l)&255,N[l+24]=s>>>8*(3-l)&255,N[l+28]=c>>>8*(3-l)&255;return N},window.SHA256.hash=function(e){for(var o=window.SHA256.digest(e),t="",i=0;i<o.length;i++){var n="0"+o[i].toString(16);t+=2<n.length?n.substring(1):n}return t})},prevPage:function(currUrlPath){var p_storage,c_storage,expires,previousPage;return window.sessionStorage&&"object"==typeof window.sessionStorage&&window.sessionStorage?(p_storage=sessionStorage.getItem("prevPage")||"",c_storage=sessionStorage.getItem("currPage")||"",previousPage="",(expires=parseInt(sessionStorage.getItem("pageExpires")||0))&&expires<(new Date).getTime()&&(sessionStorage.removeItem("prevPage"),sessionStorage.removeItem("currPage"),sessionStorage.removeItem("pageExpires"),_gtm.prevPage(currUrlPath)),c_storage&&currUrlPath!=c_storage?(sessionStorage.setItem("currPage",currUrlPath),sessionStorage.setItem("prevPage",c_storage),previousPage=c_storage):c_storage?p_storage&&currUrlPath==c_storage&&(previousPage=p_storage):sessionStorage.setItem("currPage",currUrlPath),sessionStorage.setItem("pageExpires",(new Date).getTime()+18e5),previousPage):""},checkRemoveReferrerCookie:function(){return""}},function(){var dLGlobalFuncsObj=gtmDataLayer.get("dLGlobalFuncs")||{};dLGlobalFuncsObj.fpcdp=function(){for(var fpcdp="2",tld3cdp=[".com.my",".com.tr",".co.uk"],domain=document.location.hostname,i=0;i<tld3cdp.length;++i)if(-1!==domain.indexOf(tld3cdp[i],domain.length-tld3cdp[i].length)){fpcdp="3";break}return fpcdp},dLGlobalFuncsObj.isDebugMode=function(){return!!(document.querySelector("script[src*='debug/bootstrap']")||document.cookie.match(/ait_(debug|qa|dev)/i)||window.localStorage&&"object"==typeof window.localStorage&&window.localStorage&&"function"==typeof window.localStorage.getItem&&(window.localStorage.getItem("ait_qa")||window.localStorage&&window.localStorage.getItem("ait_dev")||window.localStorage&&window.localStorage.getItem("ait_debug"))||location&&location.search&&location.search.match(/debug|qa|dev/i))},gtmDataLayer.set("dLGlobalFuncs",dLGlobalFuncsObj)}(),function(){var dLGlobalFuncs=gtmDataLayer.get("dLGlobalFuncs"),fpcdp=dLGlobalFuncs.fpcdp(),isDebugMode=dLGlobalFuncs.isDebugMode(),country=gtmDataLayer.get("country")||gtmDataLayer.get("platformData.country"),dLPlatformFuncsObj={appPropAA:function(){var cleanParam;return _gtm.getQueryParam("appprop")?(cleanParam=_gtm.getQueryParam("appprop").replace(/\+/g," "),_gtm.setCookie(encodeURIComponent(cleanParam),fpcdp,"s_app_property")):cleanParam=(cleanParam=_gtm.getCookie("s_app_property"))&&decodeURIComponent(cleanParam),cleanParam||null},appConsumerAA:function(){var consumer=_gtm.getQueryParam("consumer");return consumer?_gtm.setCookie(encodeURIComponent(consumer),fpcdp,"s_app_consumer"):consumer=document.documentElement.getAttribute("data-consumer")?document.documentElement.getAttribute("data-consumer"):(consumer=_gtm.getCookie("s_app_consumer"))&&decodeURIComponent(consumer),consumer},rsids:function(){var appPropAA=dLPlatformFuncsObj.appPropAA(),env=gtmDataLayer.get("env"),country=gtmDataLayer.get("country")||"uk",env=env&&/pro?d/i.test(env)&&!isDebugMode&&!/prodtest|ppe/i.test(appPropAA)?"prod":"dev";return"tesco"+("uk"==country.toLowerCase()?"uk":"int")+"groceries"+env+(/uk|ie/i.test(country)||/dev/i.test(env)?"":","+{CZ:"tescoINTGroceriesCZE",SK:"tescoINTGroceriesSVK",HU:"tescoINTGroceriesHUN"}[country.toUpperCase()])},appSiteNamePlatform:function(){var consumer=dLPlatformFuncsObj.appConsumerAA();return"UK"===country?"ghs:app:"+country:consumer.match(/^mca.*/gi)?"mca:app:"+country:"ighs:app:"+country},appVisitorId:function(){var appvi=_gtm.getQueryParam("appvi");return appvi?_gtm.setCookie(encodeURIComponent(appvi),fpcdp,"s_app_visitor_id"):appvi=(appvi=_gtm.getCookie("s_app_visitor_id"))&&decodeURIComponent(appvi),appvi},appDeviceNameVersion:function(){var dviClean,dviMessy1=_gtm.getQueryParam("dvi");return dviMessy1?(dviClean=dviMessy1.replace(/_/g," ").replace(/-/g,".").replace(/\+/g," "),_gtm.setCookie(encodeURIComponent(dviClean),fpcdp,"s_app_device_name_version")):dviClean=(dviClean=_gtm.getCookie("s_app_device_name_version"))&&decodeURIComponent(dviClean),dviClean},authenticationStatus:function(){var customerData=gtmDataLayer.get("customerData");return customerData&&customerData.authenticatedLogin?"logged in":"anonymous"},currencyCode:function(){var currencyCodes={CZ:"CZK",HU:"HUF",SK:"EUR",UK:"GBP",IE:"EUR"},country=gtmDataLayer.get("country")&&gtmDataLayer.get("country").toUpperCase()||"UK";return"string"==typeof currencyCodes[country]?currencyCodes[country]:""}};gtmDataLayer.set("country",country.toUpperCase()),gtmDataLayer.set("dLPlatformFuncs",dLPlatformFuncsObj)}(),function(){try{bertie.on("basicOp",function(e){var isDeferred=(e="string"==typeof e.bertieVersion&&700<parseInt(e.bertieVersion.replace(/\./g,""))?e.basicOp:e).isDeferred||null,interactType=e.component||"",interactValue=e.feature||"",genericEvent45Value=(interactType+":"+interactValue).toLowerCase(),linkName="Generic Event",basicOpObj={component:interactType,feature:interactValue,isDeferred:isDeferred,genericEvent45:genericEvent45Value};"cancel amend"==interactValue&&(linkName="Cancel Amend"),"cancel order"==interactValue&&(linkName="Cancel Order"),/:impression/i.test(genericEvent45Value)&&(linkName="Generic Impression"),e.contextValue&&(basicOpObj.contextValue=e.contextValue),basicOpObj.interactLinkName=linkName,gtmDataLayer.set("basicOp",basicOpObj),"cancel order"==interactValue&&"object"==typeof gtmDataLayer&&gtmDataLayer.get("marketingInteractions")&&gtmDataLayer.get("marketingInteractions").ga4cancelledOrder(),_gtm.notify("GTM: basicOp"),isDeferred&&(_gtm.sessionStorage.set("dtmPassVal",genericEvent45Value),_gtm.sessionStorage.set("componentPassVal",interactType),_gtm.notify("GTM: v45 value stored")),isDeferred||(cookieBannerAvailable&&expCookieTrue&&gtmDataLayer.get("customEventSetVars").genericEventAA(),_gtm.notify("GTM: genericEventSetVars called"))})}catch(e){var errorsObj=gtmDataLayer.get("errors")||{};errorsObj.basicOp=errorsObj.basicOp||{},errorsObj.basicOp.eMesssage=errorsObj.basicOp.eMesssage?errorsObj.basicOp.eMesssage+"|"+e:e,gtmDataLayer.set("errors",errorsObj)}}(),function(){try{bertie.on("basketData",function(e){var deliveryMethod,slotEnd,UIEndTimePos,slotStart,UIStartTimePos,basketDataObj={basketId:(e=e.bertieVersion&&7<=parseFloat(e.bertieVersion)?e.basketData:e).basketId,basketFullness:e.basketFullness,uniqueProducts:e.uniqueProducts,basketStatus:e.status||"",secondBasketId:e.secondBasketId||"",totalProducts:e.totalProducts},e=e.deliverySlot;e&&(deliveryMethod=e.method,slotStart=e.slotStart,"string"==typeof(slotEnd=e.slotEnd)&&slotEnd.match(/(\d+-?)+(T|\s)\d+:\d+/i)&&"string"==typeof slotStart&&slotStart.match(/(\d+-?)+(T|\s)\d+:\d+/i)&&(UIStartTimePos=slotStart.match(/(\d+-?)+T\d+:\d+/i)?slotStart.indexOf("T",0):slotStart.indexOf(" ",0),UIStartTimePos=slotStart.substring(UIStartTimePos+1,UIStartTimePos+6),UIEndTimePos=slotEnd.match(/(\d+-?)+T\d+:\d+/i)?slotEnd.indexOf("T",0):slotEnd.indexOf(" ",0),slotEnd=slotEnd.substring(UIEndTimePos+1,UIEndTimePos+6),UIEndTimePos=slotStart.substring(0,10).replace(/-/g,"")+"-"+UIStartTimePos+"-"+slotEnd,slotStart=UIStartTimePos.substring(0,2),UIStartTimePos=deliveryMethod+" "+(slotEnd.substring(0,2)-slotStart)+" hour"),basketDataObj.delSlotExp=e.isExpired,basketDataObj.slotBookedTime=UIEndTimePos,basketDataObj.deliveryMethod=UIStartTimePos),gtmDataLayer.set("basketData",basketDataObj),_gtm.notify("GTM: basketData")})}catch(e){var errorsObj=gtmDataLayer.get("errors")||{};errorsObj.basketData=errorsObj.basketData||{},errorsObj.basketData.eMesssage=errorsObj.basketData.eMesssage?errorsObj.basketData.eMesssage+"|"+e:e,gtmDataLayer.set("errors",errorsObj)}}(),function(){try{bertie.on("basketOp",function(e){function logError(message,errorObj){_gtm&&"function"==typeof _gtm.getCookie&&_gtm.getCookie("ait_dev")&&console.error(message,errorObj)}gtmDataLayer.set("basketOp",null);var basketId=(e="string"==typeof e.bertieVersion&&700<parseInt(e.bertieVersion.replace(/\./g,""))?e.basketOp:e).basketId||"not set",basketFullness=e.basketFullness||null,addIdent=(basketId&&0<=basketId.indexOf("_")&&(basketString=basketId.indexOf("_"),basketId=basketId.substring(0,basketString)),e.identifier||""),basketString=e.flag&&e.flag.anonymous?e.flag.anonymous:null,basketId=(1==basketString&&(basketString="y"),e.flag&&e.flag.isOpen?e.flag.isOpen:null),basketIntType=e.interactionType||null,productArrayExists="object"==typeof e.product&&e.product.length,linkNameBasic="",linkNameAppend="",isAddAll="",seedProductId="",unitsEvent="",revEvent="",revEventLocal="",productIds=[],avStarRatingFlag=!1,noStarRatingFlag=!1,starRating="",starReview="",stringToSend=("add"!==basketIntType&&"addAll"!==basketIntType||(unitsEvent="event26=",revEvent="event27=",revEventLocal="event210="),"remove"!==basketIntType&&"removeAll"!==basketIntType||(unitsEvent="event28=",revEvent="event29=",revEventLocal="event211="),[]),unitsPerProd=[],totalItemsCount=0,rank=null,productId=null;switch(productArrayExists&&e.product.forEach(function(item){var promotionId,isProposition,productInfo=[],isFav="boolean"==typeof item.isFavourite&&item.isFavourite?item.isFavourite:null,prodMeth=item.productMethod||"empty",tpnb=item.tpnb||null,prodQty=item.qtyChange||0,sellerId=item.sellerId||"not set",gtin=item.gtin||"",isMpProduct="ghs"!==sellerId&&"not set"!==sellerId,prodRev="",promotion=(isMpProduct?productId=e.product[0].gtin:e.product[0].tpnb&&(productId=e.product[0].tpnb),rank=e.position||0,item.offer&&item.offer.length?item.offer:null),promoEvar="no";if(promotion&&(promotionId=[],isProposition=[],promotion.forEach(function(obj){null!=obj.offerId&&promotionId.push(obj.offerId),null!=obj.proposition&&isProposition.push(obj.proposition)}),promotionId=promotionId.length?promotionId.join("~"):"",isProposition=isProposition.length?isProposition.join("~"):"",promoEvar=promotionId||"no"),item.seedProduct&&item.seedProduct.tpnb&&(seedProductId=item.seedProduct.tpnb),/trex/i.test(addIdent)||_gtm.sessionStorage.get("listStoreSP")&&_gtm.sessionStorage.get("clickedEngineStored"))for(var retrieveObj=JSON.parse(_gtm.sessionStorage.get("listStoreSP")),i=0;i<retrieveObj.length;i++){var actualItem=retrieveObj[i];if(null!=productId&&actualItem.includes(productId)){_gtm.sessionStorage.set("clickedEngineStored","trex"),_gtm.sessionStorage.set("clickedItemStored",actualItem);break}}item.totalPriceChange&&item.totalPriceChange.price&&(prodRev=parseFloat(item.totalPriceChange.price).toFixed(2));productInfo=function manageProductId(productInfo,pID){return productInfo&&pID&&"string"==typeof pID?(productInfo.push(null,pID,null,null),productInfo):(logError("manageProductId Error in arguments: ",{productInfo:productInfo,pID:pID}),productInfo||[])}(productInfo,isMpProduct?gtin:tpnb),promotion=unitsEvent+Math.abs(prodQty)+"|"+revEvent+Math.abs(prodRev)+"|"+revEventLocal+Math.abs(prodRev),null!==rank&&"remove"!=basketIntType&&(promotion+="|event169="+rank),"object"==typeof e.product&&e.product.length&&e.product[0].rating&&(e.product[0].rating.averageRating&&(starRating=parseFloat(e.product[0].rating.averageRating),starRating=isNaN(starRating)?0:10*starRating),e.product[0].rating.noOfRating&&(starReview=e.product[0].rating.noOfRating),starRating&&(avStarRatingFlag=avStarRatingFlag||!0,promotion+="|event38="+starRating),starReview)&&(promotion+="|event39="+starReview,noStarRatingFlag=noStarRatingFlag||!0),productInfo.push(promotion),isMpProduct="evar130="+prodMeth,isMpProduct=function sellerIdeVar(prodEvarStr,eVarToPopulate,sellerId){return"string"!=typeof prodEvarStr||"string"!=typeof eVarToPopulate||"string"!=typeof sellerId?(logError("sellerIdeVar Error in arguments: ",{prodEvarStr:prodEvarStr,eVarToPopulate:eVarToPopulate,sellerId:sellerId}),prodEvarStr||""):sellerId?prodEvarStr+"|"+eVarToPopulate+"="+sellerId:prodEvarStr}(isMpProduct+="|eVar186="+promoEvar,"eVar106",sellerId||null),null!==rank&&"remove"!=basketIntType&&(isMpProduct+="|eVar98="+rank),"add"!==basketIntType&&"addAll"!==basketIntType||(isMpProduct+=isFav?"|evar128=fav":""),isMpProduct=isMpProduct+(promotionId?"|eVar123=y":"|eVar123=n")+(isProposition?"|eVar169="+isProposition:"|eVar169=no"),gtin=item.availability?item.availability.toLowerCase():"";item.seedLookup?isMpProduct+="|eVar64="+gtin+":"+item.seedLookup.replace(":"," "):isMpProduct+="|eVar64="+gtin+":na",/sponsored:citrus/i.test(addIdent)&&(isMpProduct+="|eVar4=citrusAds",linkNameAppend=" Sponsored Media"),productInfo.push(isMpProduct),stringToSend.push(productInfo.join(";")),unitsPerProd.push(prodQty),totalItemsCount=unitsPerProd.reduce(function add(a,b){return a+b},0)}),"removeAllProducts"==basketIntType&&(addIdent="emptyBasket"),basketIntType){case"add":linkNameBasic="Basket Add"+linkNameAppend;break;case"addAll":linkNameBasic="Basket Add",isAddAll=!0;break;case"remove":linkNameBasic="Basket Remove";break;case"removeAll":linkNameBasic="Basket Empty";break;default:linkNameBasic="basket interaction"}0<e.product.length&&e.product.map(function(x){"ghs"!==x.sellerId&&"not set"!==x.sellerId&&x.gtin?productIds.push(x.gtin):productIds.push(x.tpnb)}),productArrayExists={prodString:stringToSend,totalItemsCount:totalItemsCount,isAnon:basketString,identifier:addIdent,isOpen:basketId,seedProductId:seedProductId,interactionType:basketIntType,linkName:linkNameBasic,isAddAll:isAddAll,basketFullness:basketFullness,productIds:productIds,prodArray:e.product,avStarRatingFlag:avStarRatingFlag,noStarRatingFlag:noStarRatingFlag,secondBasketId:e.secondBasketId||""},gtmDataLayer.set("basketOp",productArrayExists);var dataEnvironment=gtmDataLayer.get("env");setTimeout(function(){cookieBannerAvailable&&!expCookieTrue&&gtmDataLayer&&gtmDataLayer.get("adobeTags")?gtmDataLayer.get("adobeTags").sendImagePixel("basketInteraction",s):gtmDataLayer.get("customEventSetVars.basketInteractAA")(),(!cookieBannerAvailable||expCookieTrue||/UK/i.test(gtmDataLayer.get("country")))&&gtmDataLayer.get("marketingInteractions")&&(/add/i.test(basketIntType)&&"function"==typeof gtmDataLayer.get("marketingInteractions").ga4BasketAdd&&gtmDataLayer.get("marketingInteractions").ga4BasketAdd(),/remove/i.test(basketIntType))&&"function"==typeof gtmDataLayer.get("marketingInteractions").ga4BasketRemove&&gtmDataLayer.get("marketingInteractions").ga4BasketRemove(),cookieBannerAvailable&&!expCookieTrue||!gtmDataLayer.get("marketingInteractions")||/add/i.test(basketIntType)&&"function"==typeof gtmDataLayer.get("marketingInteractions").gaBasketAdd&&gtmDataLayer.get("marketingInteractions").gaBasketAdd(),(!cookieBannerAvailable||advCookieTrue||/UK/i.test(gtmDataLayer.get("country")))&&gtmDataLayer.get("marketingInteractions")&&/add/i.test(basketIntType)&&("function"==typeof gtmDataLayer.get("marketingInteractions").googleAdwordsBasketAdd&&gtmDataLayer.get("marketingInteractions").googleAdwordsBasketAdd(),"function"==typeof gtmDataLayer.get("marketingInteractions").doubleClickBasketAdd)&&gtmDataLayer.get("marketingInteractions").doubleClickBasketAdd(),cookieBannerAvailable&&!advCookieTrue||!gtmDataLayer.get("marketingInteractions")||/add/i.test(basketIntType)&&/pro?d/i.test(dataEnvironment)&&"function"==typeof gtmDataLayer.get("marketingInteractions").facebookBasketAdd&&gtmDataLayer.get("marketingInteractions").facebookBasketAdd()},700)}),bertie.purgeEventsOfType("basketOp")}catch(e){var errorsObj=gtmDataLayer.get("errors")||{};errorsObj.basketOp=errorsObj.basketOp||{},errorsObj.basketOp.eMesssage=errorsObj.basketOp.eMesssage?errorsObj.basketOp.eMesssage+"|"+e:e,gtmDataLayer.set("errors",errorsObj)}}(),function(){try{bertie.on("contentInteractOp",function(e){e=function(prodObject){var res,paevnt,displayArea,componentType,componentName,componentId,isFavContent,isTrexContent,isDcsContent,pathName,content;return"object"!=typeof prodObject?{listVar:"",productStr:""}:(res={listVar:"",contentClickedObj:gtmDataLayer.get("contentInteractOp")||{},componentType:"",productStr:""},componentId=componentName=componentType=displayArea=paevnt="",pathName=location.pathname,content=prodObject.content,prodObject=prodObject.interactionType,content&&(displayArea=content.displayArea||"ukn",paevnt=content.pageType||"u",componentType=content.componentType||"c",componentName=content.componentName||"",isDcsContent="c"===componentType,isFavContent="string"==typeof pathName&&pathName.match(/favorites/i)&&"f"==paevnt&&"c"==componentType,isTrexContent="r"===componentType||"t"===componentType,res.componentType=componentType,"object"==typeof content.panel&&content.panel.length&&content.panel.map(function(panel){componentId=content.componentId;var product="object"==typeof panel.product&&panel.product,campaign="",campaignId=panel.campaignId,placement=content.modulePosition||"undefined",posinpan=panel.posInModule||"undefined",contentFlag=panel.contentFlag,sellerId=product.sellerId||"not set",isMPProd="object"==typeof product&&product.gtin&&sellerId&&!/ghs|not set/.test(sellerId),isGHSProd="object"==typeof product&&product.tpnb&&sellerId&&/ghs|not set/.test(sellerId),prodInfo={productCategory:"",productName:"",quantity:"",price:"",events:[],evars:[]};product&&!content.componentType&&(res.componentType=componentType="",isDcsContent=!1),campaign=isTrexContent?componentId||campaignId:"0"==contentFlag&&panel.campaignTitle?panel.campaignTitle:campaignId,"c"!==componentType&&"t"!==componentType&&"r"!==componentType||(res.listVar+=componentType+":",res.listVar+=content.pageType?paevnt+":":":",res.listVar+=content.pageType?paevnt+":":":",res.listVar+=void 0!==campaign?campaign.toLowerCase()+":":":",res.listVar+=void 0!==placement?placement+":":":",res.listVar+=void 0!==posinpan?posinpan+":":":",res.listVar+=isTrexContent||isDcsContent||isFavContent?isMPProd?product.gtin+":":isGHSProd?product.tpnb+":":":":"",res.listVar+=displayArea+"::|"),"c"!==res.componentType&&"object"==typeof product&&(prodInfo.productName=isMPProd?product.gtin:isGHSProd?product.tpnb:"",posinpan&&(prodInfo.events.push("event169="+posinpan),prodInfo.evars.push("eVar98="+posinpan)),sellerId&&prodInfo.evars.push("eVar106="+sellerId),"sponsored"===componentName)&&campaignId&&prodInfo.evars.push("eVar4=citrusAds"),prodInfo.events=prodInfo.events.join("|"),prodInfo.evars=prodInfo.evars.join("|"),res.productStr+=prodInfo.productCategory+";",res.productStr+=prodInfo.productName+";",res.productStr+=prodInfo.quantity+";",res.productStr+=prodInfo.price+";",res.productStr+=prodInfo.events+";",res.productStr+=prodInfo.evars}),isDcsContent)&&(res.productStr=""),res.listVar=res.listVar.substring(0,res.listVar.length-1),""!=res.productStr&&(res.contentClickedObj.contentClickedProduct=res.productStr),res.componentType&&(res.contentClickedObj.componentType=res.componentType),res.contentClickedObj.contentClickedItem=res.listVar,_gtm.sessionStorage.set("ClickedItem",res.listVar),prodObject&&prodObject.match("recommender:trex")?res.contentClickedObj.linkName="Product Link Suggested Product":prodObject&&"ROS"==prodObject?res.contentClickedObj.linkName="Rest of Shelf Suggested Product":prodObject&&"sponsored:citrus"==prodObject?(res.contentClickedObj.linkName="Sponsored Product",res.contentClickedObj.interactionType=prodObject):res.contentClickedObj.linkName="UI Content Clicked",res.contentClickedObj.engine=isTrexContent?"trex":isDcsContent?"dcs":"",_gtm.sessionStorage.set("clickedEngineStored",res.contentClickedObj.engine),gtmDataLayer.set("contentInteractOp",res.contentClickedObj),res)}(e=e.bertieVersion&&7<=parseFloat(e.bertieVersion)?e.contentInteractOp:e);cookieBannerAvailable&&!expCookieTrue||"s"==e.componentType||gtmDataLayer.get("customEventSetVars").contentClickedAA()})}catch(e){var errorsObj=gtmDataLayer.get("errors")||{};errorsObj.contentInteractOp=errorsObj.contentInteractOp||{},errorsObj.contentInteractOp.eMesssage=errorsObj.contentInteractOp.eMesssage?errorsObj.contentInteractOp.eMesssage+"|"+e:e,gtmDataLayer.set("errors",errorsObj)}}(),function(){try{bertie.on("customerData",function(e){var customerFlag=(e=e.bertieVersion&&7<=parseFloat(e.bertieVersion)?e.customerData:e).customerFlag||"",isAmend=customerFlag&&customerFlag.amendMode||null,store=e.store||"",isAmend={UUID:e.UUID||"",authenticatedLogin:customerFlag&&customerFlag.authenticatedLogin?customerFlag.authenticatedLogin:"",firstTimeShopper:customerFlag&&customerFlag.firstTimeShopperLocal?customerFlag.firstTimeShopperLocal:"",customerLoyalType:customerFlag&&customerFlag.firstTimeShopperLocal&&void 0!==customerFlag.firstTimeShopperLocal?"first-time":"existing",amendStart:customerFlag&&customerFlag.amendStart?customerFlag.amendStart:"",amendMode:isAmend?"amend":"normal",storeId:store&&store.storeId?store.storeId:"",storeLocationId:store&&store.locationId?store.locationId:"",activeOrders:"number"==typeof e.activeOrders&&0==e.activeOrders?"0":e.activeOrders,dsSubId:customerFlag&&customerFlag.subscription&&customerFlag.subscription.deliverySaver&&customerFlag.subscription.deliverySaver.subscriptionId||0};dataLayer.push({customerData:isAmend})})}catch(e){var errorsObj=gtmDataLayer.get("errors")||{};errorsObj.customerData=errorsObj.customerData||{},errorsObj.customerData.eMesssage=errorsObj.customerData.eMesssage?errorsObj.customerData.eMesssage+"|"+e:e,gtmDataLayer.set("errors",errorsObj)}}(),bertie&&bertie.onAny(function(e){var isDebugMode=gtmDataLayer&&gtmDataLayer.get("dLGlobalFuncs")&&gtmDataLayer.get("dLGlobalFuncs").isDebugMode(),isProd=gtmDataLayer&&gtmDataLayer.get("env")&&gtmDataLayer.get("env").match(/pro?d/i),ename=e._eventType||e.bertieType||e["@type"],xhr=new XMLHttpRequest,country=gtmDataLayer&&gtmDataLayer.get("country")||gtmDataLayer.get("platformData.country"),ajax={url:{prod:"https://www.tesco.com/userinteraction/v1/events/route/custonline-nc",staging:"https://www-ppe.tesco.com/userinteraction/v1/events/route/custonline-nc-qa "},type:"POST",headers:{"Content-Type":"application/json"}},cookiesDeclined=gtmDataLayer.get("cookiePreferences")&&!gtmDataLayer.get("cookiePreferences").experience,isDebugMode=_gtm.getCookie("_qa")||isDebugMode||!isProd;!cookiesDeclined||country.match(/SK|HU|CZ/)||"renderedContentOp"!==ename&&"contentInteractOp"!==ename&&"basketOp"!==ename||(e.atrc&&(e.atrc=null),xhr.open(ajax.type,isDebugMode?ajax.url.staging:ajax.url.prod,!0),Object.getOwnPropertyNames(ajax.headers).map(function(header){xhr.setRequestHeader(header,ajax.headers[header])}),xhr.send(JSON.stringify(e)))}),function(){try{bertie.on("pageData",function(e){var pageDataObj={pageLanguage:(e=e.bertieVersion&&7<=parseFloat(e.bertieVersion)?e.pageData:e).pageLanguage||"",pageTitle:e.pageTitle&&e.pageTitle.replace(/(((\w+)?((-|:|\s|,|&|£|%)+)?\w+)+):?/i,"$1")||"",pageType:e.pageType&&e.pageType.replace(/(((\w+)?((-|:|\s|,|&|£|%)+)?\w+)+):?/i,"$1")||"",pageUrl:e.pageUrl||e.pageURL||"",pageNumber:e.pageNumber||0,preservedReferrer:_gtm.checkRemoveReferrerCookie()||e.preservedReferrer||e.preservedReferer||""};(e.category||[]).forEach(function(item){pageDataObj[item.catFriendlyLevel]=item.categoryName}),dataLayer.push({pageData:pageDataObj})})}catch(e){var errorsObj=gtmDataLayer.get("errors")||{};errorsObj.pageData=errorsObj.pageData||{},errorsObj.pageData.eMesssage=errorsObj.pageData.eMesssage?errorsObj.pageData.eMesssage+"|"+e:e,gtmDataLayer.set("errors",errorsObj)}}(),function(){try{bertie.on("platformData",function(e){var platformDataObj={buildVersion:(e="string"==typeof e.bertieVersion&&700<parseInt(e.bertieVersion.replace(/\./g,""))?e.platformData:e).buildVersion||"",application:e.application||"",country:e.country.toUpperCase()||"",property:e.property||""};e.device&&(platformDataObj.deviceBreakpoint=e.device.breakpoint||e.device.breakPoint||""),dataLayer.push({platformData:platformDataObj})})}catch(e){var errorsObj=gtmDataLayer.get("errors")||{};errorsObj.platformData=errorsObj.platformData||{},errorsObj.platformData.eMesssage=errorsObj.platformData.eMesssage?errorsObj.platformData.eMesssage+"|"+e:e}gtmDataLayer.set("errors",errorsObj)}(),function(){function generateListVarProdString(prodObject){if("object"!=typeof(prodObject="string"==typeof prodObject.bertieVersion&&700<parseInt(prodObject.bertieVersion.replace(/\./g,""))?prodObject.renderedContentOp:prodObject))return{listVar:"",prodString:"",prodIds:[],totalProductCount:0};var isTrexContent,isDcsContent,gridResultCountForPage,gridPageNumber,gridListSize,res={listVar:"",prodString:"",prodIds:[],prodGtins:"",totalProductCount:0,renderedContentOpObj:gtmDataLayer.get("renderedContentOp")||{}},paevnt="",displayArea="",componentType="",componentName="",starRatingImp=!1,pathName=location.pathname,isProductPage=/^\/groceries\/[a-zA-Z]{2}-[a-zA-Z]{2}\/products\/.*$/.test(pathName),pathName=(prodObject.content&&prodObject.content.length&&prodObject.content.map(function(content){displayArea=content.displayArea||"ukn",paevnt=content.pageType||"u",componentType=content.componentType||"s",componentName=content.componentName||"",isDcsContent="c"===componentType,isTrexContent="r"===componentType||"t"===componentType,gridListSize=prodObject.listSize||0,componentName.match(/standard|sponsored/i)&&(gridPageNumber=prodObject.pageNumber||0,gridResultCountForPage=content.panel&&content.panel.length?content.panel.length:0),"object"==typeof content.panel&&content.panel.length&&(content.panel.map(function(panel){var offerIds,propositions,prodData={category:"",id:"",qty:"",price:"",events:[],evars:[]},product="object"==typeof panel.product&&panel.product,contentFlag=panel.contentFlag,campaign="",placement=content.modulePosition||"undefined",posinpan=panel.posInModule||"undefined",sellerId=product&&product.sellerId?product.sellerId:"not set",componentId=content.componentId,idToUse=function getProdId(sellerId,product){return sellerId&&!/ghs|not set/i.test(sellerId)?product&&product.gtin?product.gtin:"":product&&product.tpnb?product.tpnb:""}(sellerId,product),campaign=isTrexContent?componentId:"0"==contentFlag&&panel.campaignTitle?panel.campaignTitle:panel.campaignId;"c"!==componentType&&"t"!==componentType&&"r"!==componentType||(res.listVar+=componentType+":",res.listVar+=content.pageType?paevnt+":":":",res.listVar+=content.pageType?paevnt+":":":",res.listVar+=void 0!==campaign?campaign.toLowerCase()+":":":",res.listVar+=void 0!==placement?placement+":":":",res.listVar+=void 0!==posinpan?posinpan+":":":",res.listVar+=isTrexContent||isDcsContent?idToUse+":":"",res.listVar+=displayArea+"::|"),"c"!==componentType&&("object"==typeof product&&(res.totalProductCount+=1,prodData.events.push("event5=1"),prodData.evars.push("eVar106="+sellerId),res.prodIds.push(idToUse),prodData.id=idToUse,product.gtin&&isProductPage&&"s"==componentType&&(res.prodGtins=product.gtin),product.offer&&product.offer.length&&product.offer[0]?(offerIds=[],propositions=[],product.offer.forEach(function(obj){null!=obj.offerId&&offerIds.push(obj.offerId),null!=obj.proposition&&propositions.push(obj.proposition)}),prodData.evars.push(offerIds.length?"eVar186="+offerIds.join("~")+"|eVar123=y":"eVar186=no|eVar123=n"),prodData.evars.push("eVar169="+(propositions.length?propositions.join("~"):"no"))):prodData.evars.push("eVar186=no|eVar123=n|eVar169=no"),product.rating&&product.rating.noOfRatings&&(prodData.events.push("event39="+product.rating.noOfRatings),prodData.evars.push("eVar185="+product.rating.noOfRatings)),product.rating&&product.rating.averageRating&&(componentId=parseFloat(product.rating.averageRating),componentId=isNaN(componentId)?0:10*componentId,prodData.events.push("event38="+componentId),prodData.evars.push("eVar20="+componentId),starRatingImp=starRatingImp||!0),"boolean"==typeof product.isFavourite&&product.isFavourite&&prodData.evars.push("eVar128=fav"),contentFlag=product.availability?product.availability.toLowerCase():"",product.seedLookup?(campaign=product.seedLookup.replace(":"," "),prodData.evars.push("eVar64="+contentFlag+":"+campaign)):prodData.evars.push("eVar64="+contentFlag+":na"),panel.posInModule)&&(placement=panel.posInModule,prodData.events.push("event169="+placement),prodData.evars.push("eVar98="+placement)),"sponsored"===content.componentName&&panel.campaignId&&prodData.evars.push("eVar4=citrusAds"),"multiSubs"===content.componentName&&"s"===componentType&&content.modulePosition&&prodData.evars.push("eVar28="+content.modulePosition),res.prodString=res.prodString.length?res.prodString+",":"",res.prodString+=prodData.category+";",res.prodString+=prodData.id+";",res.prodString+=prodData.qty+";",res.prodString+=prodData.price+";",res.prodString+=prodData.events.join("|")+";",res.prodString+=prodData.evars.join("|"))}),isDcsContent)&&(res.prodString="")}),res.listVar=res.listVar.substring(0,res.listVar.length-1),res.renderedContentOpObj.carouselPanelType=componentName,res.renderedContentOpObj.componentType=componentType,res.renderedContentOpObj.gridResultCountForPage=gridResultCountForPage,res.renderedContentOpObj.gridPageNumber=gridPageNumber,res.renderedContentOpObj.gridListSize=gridListSize,res.renderedContentOpObj.starRatingSet=starRatingImp,"s"!=componentType&&!/sponsored/i.test(componentName)||/carousel/i.test(componentName)||"csl"==displayArea||(res.renderedContentOpObj.prodString=res.prodString),prodObject.content&&prodObject.content.length&&(res.renderedContentOpObj.arrayOfProducts="s"==componentType?prodObject.content:[]),res.renderedContentOpObj.marketingProductIds=res.prodIds,res.renderedContentOpObj.productIDGtin=(!res.prodGtins.length||res.prodGtins===res.renderedContentOpObj.productIDGtin)&&(res.prodGtins.length&&res.prodGtins==res.renderedContentOpObj.productIDGtin||0===res.prodGtins.length)?res.renderedContentOpObj.productIDGtin:res.prodGtins,res.renderedContentOpObj.gaPdpProdId=isProductPage&&"s"==componentType?res.prodIds.join():isProductPage&&res.renderedContentOpObj.gaPdpProdId&&res.renderedContentOpObj.gaPdpProdId.length?res.renderedContentOpObj.gaPdpProdId:"",res.renderedContentOpObj.productID=res.renderedContentOpObj.gaPdpProdId,"favourites"==componentName&&"s"==componentType&&(res.renderedContentOpObj.favProdViewString=res.prodString),res.renderedContentOpObj.gridPageNumber=gridPageNumber,res.renderedContentOpObj.pageType=paevnt,res.renderedContentOpObj.contentType=displayArea,res.renderedContentOpObj.contentCampaign="",isDcsContent&&(res.renderedContentOpObj.contentMagnolia=res.listVar),isTrexContent?"trex":isDcsContent?"dcs":null),spStore=res.listVar.split("|")||[];if(pathName&&isTrexContent&&(res.renderedContentOpObj.contentEngine=pathName),isTrexContent){res.renderedContentOpObj.contentTrex=res.listVar;try{_gtm.sessionStorage.set("listStoreSP",JSON.stringify(spStore))}catch(err){_gtm.notify(err)}res.renderedContentOpObj.contentTpnbs=res.prodString,res.renderedContentOpObj.trexComponentName=componentName}return gtmDataLayer.set("renderedContentOp",res.renderedContentOpObj),"s"!=componentType||"favourites"!=componentName||cookieBannerAvailable&&!expCookieTrue||gtmDataLayer.get("customEventSetVars").favCarouselAA(),!isTrexContent||cookieBannerAvailable&&!expCookieTrue||gtmDataLayer.get("customEventSetVars").spLoadAA(),fqueue.shift(),setTimeout(function(){fqueue.length&&queueRunner()},50),res}var fqueue=[],_debouncedQueue=_gtm.debouncer(queueRunner,1);function queueRunner(){fqueue.length&&fqueue[0]&&fqueue[0].f(fqueue[0].p)}try{bertie.on("renderedContentOp",function(e){fqueue.push({f:generateListVarProdString,p:e}),_debouncedQueue()})}catch(e){var errorsObj=gtmDataLayer.get("errors")||{};errorsObj.renderedContentOp=errorsObj.renderedContentOp||{},errorsObj.renderedContentOp.eMesssage=errorsObj.renderedContentOp.eMesssage?errorsObj.renderedContentOp.eMesssage+"|"+e:e,gtmDataLayer.set("errors",errorsObj)}}(),function(){try{bertie.on("renderedExperimentOp",function(e){var exVariant=(700<parseInt(e.bertieVersion.replace(/\./g,""))&&e.renderedExperimentOp?e.renderedExperimentOp:e).experiment,timestamp=e.timestamp||e.bertieTimeStamp||(new Date).toISOString(),todayDate=timestamp.substring(0,timestamp.indexOf("T")),timestamp=[],currentExp=[];if(exVariant&&"object"==typeof exVariant&&exVariant.length&&exVariant.map(function(exp){exp=exp.experimentName+"-"+exp.variationKey;currentExp.push({V:exp,D:todayDate})}),_gtm.localStorage.get("OptVars")&&JSON.parse(_gtm.localStorage.get("OptVars")).length){var lsData=JSON.parse(_gtm.localStorage.get("OptVars")),expToPushInLs=[],timestamp=lsData.filter(function(val){return currentExp.map(function(exp){val.V===exp.V?val.D=todayDate:~JSON.stringify(expToPushInLs).indexOf(JSON.stringify(exp))||~JSON.stringify(lsData).indexOf(exp.V)||expToPushInLs.push(exp)}),(new Date).getTime()-new Date(val.D).getTime()<24192e5}),duplicates=(expToPushInLs.length&&(timestamp=timestamp.concat(expToPushInLs)),{});timestamp=timestamp.filter(function(x){return!duplicates[x.V]&&(duplicates[x.V]=!0)}),duplicates={};try{timestamp.sort(function(a,b){return a.V>b.V?1:a.V<b.V?-1:0}),timestamp.sort(function(a,b){return a.V.split("-")[0]-b.V.split("-")[0]}),_gtm.localStorage.set("OptVars",JSON.stringify(timestamp)),gtmDataLayer.set("renderedExperimentOp.busAllExperiments",timestamp)}catch(e){exVariant=gtmDataLayer.get("errors")||{};exVariant.renderedExperimentOp=exVariant.renderedExperimentOp||{},exVariant.renderedExperimentOp.eMesssage=exVariant.renderedExperimentOp.eMesssage?exVariant.renderedExperimentOp.eMesssage+"|"+e:e,gtmDataLayer.set("errors",exVariant)}}else _gtm.localStorage.set("OptVars",JSON.stringify(currentExp)),gtmDataLayer.set("renderedExperimentOp.busAllExperiments",currentExp)})}catch(e){var errorsObj=gtmDataLayer.get("errors")||{};errorsObj.renderedExperimentOp=errorsObj.renderedExperimentOp||{},errorsObj.renderedExperimentOp.eMesssage=errorsObj.renderedExperimentOp.eMesssage?errorsObj.renderedExperimentOp.eMesssage+"|"+e:e,gtmDataLayer.set("errors",errorsObj)}}(),function(){var adobeTagsObj=gtmDataLayer.get("adobeTags")||{};adobeTagsObj.sendImagePixel=function(interactionType,sObj){var params=[],rsids=gtmDataLayer.get("dLPlatformFuncs").rsids(),c10="UK"===gtmDataLayer.get("country")?"ghs:UK":"ighs:"+gtmDataLayer.get("country")||gtmDataLayer.get("platformData.country"),sObj=(params.push("c6="+encodeURIComponent(window.location.href)+"&v43="+encodeURIComponent(window.location.href)),params.push("c10="+c10+"&v9="+c10),sObj.pageName&&params.push("pageName="+encodeURIComponent(sObj.pageName)),sObj.prop4&&params.push("c4="+encodeURIComponent(sObj.prop4)),params.push("c73=1&c75=14"),"basketInteraction"===interactionType&&("addProduct"===(c10=gtmDataLayer.get("basketOp").interactionType)||"addAll"===c10||"add"===c10?params.push("events=scAdd&pe=lnk_o&pev2=Basket Add"):"removeProduct"!==c10&&"removeAllProducts"!==c10&&"remove"!==c10||params.push("events=scRemove&pe=lnk_o&pev2=Basket Remove")),Math.round(999999999999*Math.random()+1999)),interactionType=new XMLHttpRequest;interactionType.open("GET","https://smetrics.tesco.com/b/ss/"+rsids+"/1/JS-static/s"+sObj+"?AQB=1&ndh=1&pf=1&mid=anonymous&ce=UTF-8&g="+encodeURIComponent(window.location.href)+"&r="+encodeURIComponent(document.referrer)+"&"+params.join("&")+"&mcorgid=E4860C0F53CE56C40A490D45%40AdobeOrg&AQE=1"),interactionType.send(),_gtm.notify("GTM: Adobe Image Pixel Fired")},gtmDataLayer.set("adobeTags",adobeTagsObj)}(),function(){var pageLoadFunctions=gtmDataLayer.get("pageLoadSetVars")||{};cookieBannerAvailable&&!expCookieTrue&&(window.s={},s.clearVars=s.tl=s.t=s.apl=s.getPreviousValue=s.getNewRepeat=s.trackTNT=s.inList=s.split=function(){}),pageLoadFunctions.allPages=function(spa,rcFail){try{var storedVal,appPropParam,pageData=gtmDataLayer.get("pageData")||{},platformData=gtmDataLayer.get("platformData")||{},basketData=gtmDataLayer.get("basketData")||{},customerData=gtmDataLayer.get("customerData")||{},renderedContentOp=gtmDataLayer.get("renderedContentOp")||{},country=platformData.country,pageDetails=pageData&&pageData.pageTitle?pageData.pageTitle.split(":"):[],defV45Val=(window.s=window.s||{},"function"==typeof window.s.clearVars&&window.s.clearVars(),s.eVar2=_gtm.getQueryParam("icid"),s.eVar19=s.prop35=pageData.pageNumber,s.server=window.location.host+" ("+platformData.application+")",s.channel=s.prop20=country||null,s.prop43=pageData.pageLanguage,s.prop8=s.eVar22=navigator.language.toLowerCase(),s.eVar159=basketData.basketFullness,s.eVar189=basketData.totalProducts,s.eVar69=basketData.deliveryMethod,s.eVar6=basketData.slotBookedTime,s.eVar108=basketData.basketStatus,s.prop55=s.eVar107=basketData.secondBasketId,s.prop74=basketData.delSlotExp&&"string"==typeof basketData.deliveryMethod?"expired":basketData.delSlotExp||"string"!=typeof basketData.deliveryMethod?"na":"active",s.eVar191=s.prop47=basketData.uniqueProducts,customerData.firstTimeShopper&&(s.eVar7=customerData.customerLoyalType),s.eVar38=customerData.storeLocationId,s.eVar182=customerData.activeOrders,customerData.dsSubId&&(s.eVar114=customerData.dsSubId),customerData.amendStart&&(s.events?s.events+=",event40":s.events="event40"),pageData.pageTitle&&(/^\/groceries\/[a-zA-Z]{2}-[a-zA-Z]{2}\/products\/.*$/.test(window.location.pathname)?s.pageName=s.eVar3=s.eVar14=pageData.pageType+":"+pageData.pageTitle.toLowerCase():s.pageName=s.eVar3=s.eVar14=pageData.pageTitle.toLowerCase()),s.prop15=s.eVar15=s.getPreviousValue(s.pageName,"s_gpv_pn"),/^\/groceries(\/[a-zA-Z]{2}-[a-zA-Z]{2})?\/products\/.*$/.test(window.location.pathname)?(s.events=s.events?s.events+",prodView":"prodView",s.prop1=s.eVar70=pageData.pageType,s.prop2=s.prop3=s.eVar71=s.eVar72=pageData.pageType+":"+pageData.pageTitle.toLowerCase()):(s.prop1=s.eVar70=pageDetails[0],s.prop2=s.eVar71=1<pageDetails.length?pageDetails[0]+":"+pageDetails[1]:pageDetails[0],s.prop3=s.eVar72=pageDetails.join(":")),gtmDataLayer.get("renderedContentOp.starRatingSet")&&(s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event38,event39",",",",",!0),s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"event38,event39",",",",",!0),gtmDataLayer.set("renderedContentOp.starRatingSet",!1)),_gtm.sessionStorage.get("dtmPassVal")||_gtm.sessionStorage.get("gtmPassVal")),clickedItem=(defV45Val&&(s.eVar45=defV45Val.toLowerCase(),s.events="event45",_gtm.sessionStorage.get("dtmPassVal")?_gtm.sessionStorage.remove("dtmPassVal"):_gtm.sessionStorage.remove("gtmPassVal")),s.prop75="14",renderedContentOp.prodString&&(s.events=s.events?s.events+=",event3,event5":"event3,event5",s.products=renderedContentOp.prodString,s.events=s.events?s.events+=",event169":"event169",gtmDataLayer.set("renderedContentOp.prodString",!1)),s.eVar58=s.prop18=renderedContentOp.gridListSize,rcFail&&(s.products=";000000;;;;"),_gtm.sessionStorage.get("ClickedItem")||""),engine=_gtm.sessionStorage.get("engine")||"",contentMagnolia=(clickedItem&&(/^c:/i.test(storedVal=clickedItem)||/dcs/i.test(engine)?s.list2=storedVal:(s.list1=storedVal,s.eVar166="trex"),_gtm.sessionStorage.set("clickedItemStored",clickedItem),_gtm.sessionStorage.remove("ClickedItem")),gtmDataLayer.get("renderedContentOp.contentMagnolia")),v50string=(contentMagnolia&&(s.list2=s.list2?s.list2+="|"+contentMagnolia:contentMagnolia,s.eVar166="dcs",gtmDataLayer.set("renderedContentOp.contentMagnolia",!1)),[]),allExpArray=gtmDataLayer.get("renderedExperimentOp.busAllExperiments")||_gtm.localStorage.get("OptVars")&&JSON.parse(_gtm.localStorage.get("OptVars"))||[],cleanArrayToStore=allExpArray.length?allExpArray.filter(function(val){return(new Date).getTime()-new Date(val.D).getTime()<24192e5}):[],fpcdp=(cleanArrayToStore.sort(function(a,b){return a.V.split("-")[0]-b.V.split("-")[0]}),cleanArrayToStore.forEach(function(variation){v50string.push(variation.V)}),cleanArrayToStore&&cleanArrayToStore.length&&(_gtm.localStorage.set("OptVars",JSON.stringify(cleanArrayToStore)),s.list3=s.eVar50=v50string.join(",")),gtmDataLayer&&gtmDataLayer.get("dLGlobalFuncs")&&"function"==typeof gtmDataLayer.get("dLGlobalFuncs").fpcdp&&gtmDataLayer.get("dLGlobalFuncs").fpcdp()),icidValue=(_gtm.getQueryParam("appprop")&&(appPropParam=_gtm.getQueryParam("appprop").replace(/\+/g," "),_gtm.setCookie(encodeURIComponent(appPropParam),fpcdp,"s_app_property")),_gtm.getQueryParam("icid")),uicc=(icidValue&&(s.eVar2=icidValue,s.events=s.events?s.events+=",event7":"event7"),_gtm.localStorage.get("uicc"));uicc&&("null"!==uicc&&(s.eVar2=uicc),_gtm.localStorage.remove("uicc")),"error"===pageData.pageType&&"error"===pageData.pageTitle&&(s.events="event110",s.prop38=s.eVar48=gtmDataLayer.get("errorOp.errorString"),s.eVar70=s.prop1="error",s.eVar71=s.prop2="error",s.eVar72=s.prop3="error"),gtmDataLayer.set("pageData.v70",s.eVar70),gtmDataLayer.set("pageData.v71",s.eVar71),gtmDataLayer.set("pageData.v72",s.eVar72),cookieBannerAvailable&&!expCookieTrue&&gtmDataLayer&&gtmDataLayer.get("adobeTags")?gtmDataLayer.get("adobeTags").sendImagePixel("pageLoad",s):"function"==typeof window.s.t&&window.s.t(),_gtm.notify("GTM: allPages fired")}catch(e){_gtm.notify(e)}},gtmDataLayer.set("pageLoadSetVars",pageLoadFunctions)}(),function(){var customEventSetVarsObj=gtmDataLayer.get("customEventSetVars")||{};customEventSetVarsObj.spLoadAA=function(){window.s=window.s||{},"function"==typeof window.s.clearVars&&window.s.clearVars(),_gtm.notify("prod string---start",gtmDataLayer.get("renderedContentOp.contentTpnbs")),_gtm.notify("display area---start",gtmDataLayer.get("renderedContentOp.pageType"));var _dtmUrl=location.href,listValue=gtmDataLayer.get("renderedContentOp.contentTrex")||"",engine=gtmDataLayer.get("renderedContentOp.contentEngine")||"",pageType=gtmDataLayer.get("renderedContentOp.pageType")||"",prodString=gtmDataLayer.get("renderedContentOp.contentTpnbs")||"";-1===_dtmUrl.indexOf("help")&&listValue&&(listValue.match(/^c:/i)?(s.linkTrackVars+=",list2",s.list2=listValue):(s.linkTrackVars+=",list1",s.list1=listValue),gtmDataLayer.set("renderedContentOp.contentTrex",null),listValue="",gtmDataLayer.set("renderedContentOp.trexCount",null),engine)&&(s.linkTrackVars=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackVars,"events,eVar166,prop1,prop2,prop3,prop4,prop75,eVar70,eVar71,eVar72,eVar73",",",1),s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event167",",",1),s.events="event167",s.eVar166=engine,_gtm.notify("GTM: ----v70",gtmDataLayer.get("pageData.v70")),s.prop1=s.eVar70=gtmDataLayer.get("pageData.v70"),s.prop2=s.eVar71=gtmDataLayer.get("pageData.v71"),s.prop3=s.eVar72=gtmDataLayer.get("pageData.v72"),s.prop75="14",pageType&&"p"===pageType&&(s.prop4=s.eVar73="pdp"),prodString)&&(_gtm.notify("GTM: using prodString from UIRenderContent"),_gtm.notify("GTM: prod string is "+prodString),s.products?s.products+=","+prodString:(s.products=prodString,s.linkTrackVars=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackVars,"products,eVar98",",",1),s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event3,event5,event169",",",1),s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"event3,event5,event169",",",1)),gtmDataLayer.set("renderedContentOp.contentTpnbs",null)),_gtm.notify("GTM: SP Loaded complete"),"function"==typeof window.s.tl&&window.s.tl(!0,"o","SP Loaded")},gtmDataLayer.set("customEventSetVars",customEventSetVarsObj)}(),function(){var customEventSetVarsObj=gtmDataLayer.get("customEventSetVars")||{};customEventSetVarsObj.basketInteractAA=function(){var basketOp=gtmDataLayer.get("basketOp")||{},hasAverageStarRating=basketOp.avStarRatingFlag,hasNoStarRating=basketOp.noStarRatingFlag,basketProdStr=basketOp.prodString,anonAdd=basketOp.isAnon,isOpen=basketOp.isOpen,seedProduct=basketOp.seedProductId,opIdent=basketOp.identifier,isAddAll=basketOp.isAddAll,linkName=basketOp.linkName,interactionType=basketOp.interactionType,basketFullness=basketOp.basketFullness,pageData=gtmDataLayer.get("pageData")||{},engineRendered=gtmDataLayer.get("renderedContentOp.contentEngine")||null,engineClicked=_gtm.sessionStorage.get("clickedEngineStored")||null,listValClicked=_gtm.sessionStorage.get("clickedItemStored")||null,secondBasketId=basketOp.secondBasketId||"",basketData=gtmDataLayer.get("basketData")||{};window.s=window.s||{},"function"==typeof window.s.clearVars&&window.s.clearVars(),s.prop75="14",s.products=basketProdStr,s.eVar159=basketFullness,s.eVar189=basketData.totalProducts,s.eVar191=s.prop47=basketData.uniqueProducts,s.linkTrackVars="events,products,prop75,eVar130,eVar159,eVar189,eVar191",gtmDataLayer.set("basketOp.prodString",""),!interactionType||"remove"!=interactionType&&"empty"!=interactionType||(s.linkTrackEvents="scRemove,event28,event29,event211",s.events="scRemove,event28,event29,event211","empty"==interactionType&&(s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"event9",",",",",!0),s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event9",",",",",!0)),s.prop4=s.eVar73=gtmDataLayer.get("pageData.v73"),"object"==typeof basketOp.prodArray&&basketOp.prodArray.length&&basketOp.prodArray[0].rating&&(hasAverageStarRating&&(s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event38",",",",",!0),s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"event38",",",",",!0),gtmDataLayer.set("basketOp.avStarRatingFlag",!1)),hasNoStarRating)&&(s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event39",",",",",!0),s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"event39",",",",",!0),gtmDataLayer.set("basketOp.noStarRatingFlag",!1))),interactionType&&("add"==interactionType||"addAll"==interactionType)&&(s.linkTrackEvents="scAdd,event26,event27,event210",s.events="scAdd,event26,event27,event210",s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"event169",",",",",!0),s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event169",",",",",!0),s.eVar61=pageData.pageType+":"+opIdent,s.linkTrackVars=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackVars,"eVar61",",",",",!0),opIdent.match(/trex/i)||"pdp"==opIdent&&listValClicked)&&(linkName+=" Suggested Product",s.list1=listValClicked,s.eVar166=engineRendered||engineClicked,s.eVar61=pageData.pageType+":recommender:trex",s.linkTrackVars=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackVars,"eVar166,list1",",",",",!0)),"y"==anonAdd&&(s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"event17",",",",",!0),s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event17",",",",",!0)),!0!==isOpen&&"true"!==isOpen||(s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"scOpen",",",",",!0),s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"scOpen",",",",",!0)),isAddAll&&(s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event46",",",",",!0),s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"event46",",",",",!0)),seedProduct&&(s.linkTrackVars=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackVars,"eVar151",",",",",!0),s.eVar151=seedProduct),secondBasketId&&(s.prop55=s.eVar107=basketOp.secondBasketId,s.linkTrackVars=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackVars,"eVar107,prop55",",",",",!0)),s.products=basketProdStr,s.prop4=s.eVar73=pageData.pageType,s.prop1=s.eVar70=pageData.v70,s.prop2=s.eVar71=pageData.v71,s.prop3=s.eVar72=pageData.v72,s.linkTrackVars=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackVars,"prop1,prop2,prop3,prop4,prop60,eVar60,eVar70,eVar71,eVar72,eVar73",",",",",!0),"object"==typeof basketOp.prodArray&&basketOp.prodArray.length&&basketOp.prodArray[0].rating&&(hasAverageStarRating&&(s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event38",",",",",!0),s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"event38",",",",",!0),gtmDataLayer.set("basketOp.avStarRatingFlag",!1)),hasNoStarRating)&&(s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event39",",",",",!0),s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"event39",",",",",!0),gtmDataLayer.set("basketOp.noStarRatingFlag",!1)),"function"==typeof window.s.tl&&window.s.tl(!0,"o",linkName),_gtm.notify("GTM: basketInteraction fired")},gtmDataLayer.set("customEventSetVars",customEventSetVarsObj)}(),function(){var customEventSetVarsObj=gtmDataLayer.get("customEventSetVars")||{};customEventSetVarsObj.contentClickedAA=function(){window.s=window.s||{},"function"==typeof window.s.clearVars&&window.s.clearVars();var contentInteractOp=gtmDataLayer.get("contentInteractOp"),lvar=contentInteractOp.contentClickedItem||null,engine=contentInteractOp.engine||null,contentType=contentInteractOp.componentType||"",linkName=contentInteractOp.linkName||null,productStr=contentInteractOp.contentClickedProduct||null,contentInteractOp=(gtmDataLayer.set("contentInteractOp.contentClickedItem",null),gtmDataLayer.set("contentInteractOp.linkName",null),gtmDataLayer.set("contentInteractOp.contentClickedProduct",null),contentInteractOp.interactionType||"");s.events="event45",s.linkTrackEvents="event45",engine&&/dcs/i.test(engine)||"c"==contentType?(s.list2=lvar,s.linkTrackVars="list2"):(s.list1=lvar,s.linkTrackVars="list1"),s.linkTrackVars+=",eVar45,eVar51,eVar70,eVar71,eVar72,eVar73,prop1,prop2,prop3,prop4,prop75",s.prop1=s.eVar70=gtmDataLayer.get("pageData.v70"),s.prop2=s.eVar71=gtmDataLayer.get("pageData.v71"),s.prop3=s.eVar72=gtmDataLayer.get("pageData.v72"),s.prop4=s.eVar73=gtmDataLayer.get("pageData.v73"),s.prop75="14";try{_gtm.localStorage.set("uicc",lvar)}catch(err){_gtm.notify(err)}productStr&&(s.products=productStr,s.linkTrackEvents+=",event169",s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event169",",",",",!0),s.linkTrackVars=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackVars,"products",",",",",!0)),/trex/i.test(engine)?(s.linkTrackVars+=",eVar49,eVar166",s.eVar45="recommender:"+engine,s.eVar49="carousel",s.eVar166="trex"):(s.linkTrackVars+=",eVar166",s.eVar45=lvar,s.eVar166=engine),"sponsored:citrus"==contentInteractOp&&(s.linkTrackVars+=",eVar49",s.eVar45="pdp:sponsored:citrus",s.eVar49="pdp",gtmDataLayer.set("contentInteractOp.UIClickContentInteractionType",null)),_gtm.notify("GTM: contentClicked fired"),"function"==typeof window.s.tl&&window.s.tl(!0,"o",linkName)},gtmDataLayer.set("customEventSetVars",customEventSetVarsObj)}(),function(){var customEventSetVarsObj=gtmDataLayer.get("customEventSetVars")||{};customEventSetVarsObj.errorOpAA=function(){try{var errorData=gtmDataLayer.get("errorOp"),eMessage=errorData.code?errorData.errorCode:"";eMessage?eMessage+=":"+errorData.errorMessage:errorData.errorMessage,window.s=window.s||{},"function"==typeof window.s.clearVars&&window.s.clearVars(),s.linkTrackVars="prop38,prop75,eVar48,eVar152,events",s.linkTrackEvents="event11",s.events="event11",s.prop38=eMessage,s.eVar48="D=c38",s.prop75="14",_gtm.notify("GTM: errorOp fired")}catch(e){_gtm.notify(e)}},gtmDataLayer.set("customEventSetVars",customEventSetVarsObj)}(),function(){var customEventSetVarsObj=gtmDataLayer.get("customEventSetVars")||{};customEventSetVarsObj.favCarouselAA=function(){window.s=window.s||{},"function"==typeof window.s.clearVars&&window.s.clearVars();var renderedContentOp=gtmDataLayer.get("renderedContentOp")||{},carouselPanelType=renderedContentOp.carouselPanelType,componentType=renderedContentOp.componentType,renderedContentOp=renderedContentOp.favProdViewString,linkName="";"s"==componentType&&"favourites"==carouselPanelType&&(s.linkTrackVars=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackVars,"events,eVar166,prop1,prop2,prop3,prop4,prop75,eVar70,eVar71,eVar72,eVar73",",",1),_gtm.notify("GTM: ----v70",gtmDataLayer.get("pageData.v70")),s.prop1=s.eVar70=gtmDataLayer.get("pageData.v70"),s.prop2=s.eVar71=gtmDataLayer.get("pageData.v71"),s.prop3=s.eVar72=gtmDataLayer.get("pageData.v72"),s.prop4=s.eVar73=gtmDataLayer.get("pageData.v73"),s.prop75="14",renderedContentOp&&(_gtm.notify("GTM: using prodString from UIRenderContent"),_gtm.notify("GTM: prod string is "+renderedContentOp),s.products=renderedContentOp,s.linkTrackVars=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackVars,"products,eVar98",",",1),s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event3,event5,event169",",",1),s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"event3,event5,event169",",",1),gtmDataLayer.set("renderedContentOp.contentTpnbs",null)),linkName=carouselPanelType+" carousel"),"function"==typeof window.s.tl&&window.s.tl(!0,"o",linkName),_gtm.notify("GTM: favCarousel fired")},gtmDataLayer.set("customEventSetVars",customEventSetVarsObj)}(),function(){var customEventSetVarsObj=gtmDataLayer.get("customEventSetVars")||{};customEventSetVarsObj.genericEventAA=function(){try{window.s=window.s||{},"function"==typeof window.s.clearVars&&window.s.clearVars();var v45Value=gtmDataLayer.get("basicOp.genericEvent45"),linkVarStr="events,prop1,prop2,prop3,prop19,prop39,prop75,eVar70,eVar71,eVar72,eVar45,eVar49",linkName=gtmDataLayer.get("basicOp.interactLinkName")||"Generic Event",contextValue=gtmDataLayer.get("basicOp.contextValue")||"",basicComponent=gtmDataLayer.get("basicOp.component")||null;s.linkTrackEvents="event45",s.events="event45",s.prop19=s.eVar45=v45Value,s.prop39=s.eVar49=gtmDataLayer.get("basicOp.component"),s.prop75="14","cancel amend"==linkName.toLowerCase()&&(s.linkTrackEvents+=",event83",s.events+=",event83",s.eVar10=contextValue,linkVarStr+=",eVar10"),"cancel order"==linkName.toLowerCase()&&(s.linkTrackEvents="event44",s.events="event44",s.eVar10=contextValue,s.prop19=s.eVar45="",s.prop39=s.eVar49="",linkVarStr+=",eVar10"),"generic impression"==linkName.toLowerCase()&&(s.events="event170",s.eVar170=v45Value,s.prop19=s.eVar45="",s.prop39=s.eVar49="",s.linkTrackVars=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackVars,"eVar170",",",1),s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event170",",",1)),basicComponent&&"star rating"==basicComponent&&(s.linkTrackVars=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackVars,"products",",",1),s.linkTrackEvents=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.linkTrackEvents,"event92",",",1),s.events=window.s&&"function"==typeof window.s.apl&&window.s.apl(s.events,"event92",",",1),s.products=";"+contextValue),s.prop1=s.eVar70=gtmDataLayer.get("pageData.v70"),s.prop2=s.eVar71=gtmDataLayer.get("pageData.v71"),s.prop3=s.eVar72=gtmDataLayer.get("pageData.v72"),s.linkTrackVars?s.linkTrackVars+=","+linkVarStr:s.linkTrackVars=linkVarStr,_gtm.notify("GTM: genericEvent fired"),"function"==typeof window.s.tl&&window.s.tl(!0,"o",linkName)}catch(e){_gtm.notify(e)}},gtmDataLayer.set("customEventSetVars",customEventSetVarsObj)}(),function(w){try{gtmDataLayer.get("dLGlobalFuncs.isDebugMode")()&&bertie&&bertie.onAny(console.log)}catch(e){return}var db,_replaceState,_pushState,_yy_pl={pageData:!1,platformData:!1,siteData:!1,customerData:!1,basketData:!1,UIEventBasket:!1,trolleyData:!1,orderData:!1,renderedContentOp:!1,type:""},rcTout=0;function getPageType(path){return/\/confirmation/i.test(path)?"checkout:conf":/\/have-you-forgotten/i.test(path)?"checkout:hyf":/\/order-summary/i.test(path)?"checkout:osum":/\/recommendations/i.test(path)?"checkout:recs":/\/search|shop(\/\w+)+/i.test(path)?"plp":/^\/phones\/products/i.test(path)?"phones:pdp":/\/products?\/\w+/i.test(path)?"pdp":/(^\/groceries(\/\w{2}-\w{2})?\/?)$/i.test(path)?"home":/\/orders\/(\d+-?){3}/i.test(path)?"orders:detail":/\/orders\/?$/i.test(path)?"orders:list":/\/favorites(\/?\w+)?/i.test(path)?"fav":/\w+\/zones?\/?(\w+)?/i.test(path)?"zone":/\/slots\/\w+/i.test(path)?"slots":/\/trolley/i.test(path)?"trolley":/^\/zones/i.test(path)?"bloks:zones":/^\/$/i.test(path)?"bloks:home":/payment/i.test(path)?"payment":/checkout\/([\w-]+\/)?phones$/i.test(path)?"checkout:phones:osum":/^\/phones\/?$/i.test(path)?"phones:home":/^\/phones\/buylists/i.test(path)?"phones:buylists":""}function resetMainFlags(){rcTout&&(clearTimeout(rcTout),rcTout=0),_yy_pl.pageData=_yy_pl.platformData=_yy_pl.siteData=_yy_pl.customerData=_yy_pl.basketData=_yy_pl.UIEventBasket=_yy_pl.renderedContentOp=!1}function firePageLoadEvent(eName,rcFail){var newDomEvent,eName=eName||"pageLoad";_gtm.sessionStorage.get("clickedEngineStored")&&_gtm.sessionStorage.remove("clickedEngineStored"),_gtm.sessionStorage.get("clickedItemStored")&&_gtm.sessionStorage.remove("clickedItemStored"),gtmDataLayer.get("pageLoadSetVars")&&gtmDataLayer.get("pageLoadSetVars").allPages&&"function"==typeof gtmDataLayer.get("pageLoadSetVars").allPages&&_gtm.throttle(gtmDataLayer.get("pageLoadSetVars").allPages,1e3)(!1,rcFail),w.dataLayer&&w.dataLayer.push({event:"custom:"+eName}),-1!==navigator.userAgent.indexOf("MSIE")||0<navigator.appVersion.indexOf("Trident/")?(newDomEvent=document.createEvent("Event")).initEvent(eName,!0,!0):newDomEvent=new Event(eName),window.dispatchEvent(newDomEvent),gtmDataLayer.set(eName,"true")}window.history&&(_replaceState=history.replaceState.bind(history),_pushState=history.pushState.bind(history),window.history.replaceState=function(){resetMainFlags(),_yy_pl.renderedContentOp=!1,gtmDataLayer.set("coreDataLoaded",null),_replaceState.apply(history,arguments)},window.history.pushState=function(){resetMainFlags(),_yy_pl.renderedContentOp=!1,gtmDataLayer.set("coreDataLoaded",null),_pushState.apply(history,arguments)}),w.bertie.onAny(function waitForPageloadData(e){var path=location.pathname,host=location.hostname,host=getPageType(!!/platba|payment|fizetes/i.test(host)?host.replace(/\./gi,"/"):path);_yy_pl.type=e["@type"]||e.bertieType||"",/phones/.test(path)&&!/checkout/.test(path)&&(_yy_pl.type=_yy_pl.type.replace("tesco:",""),_yy_pl.customerData=!0,_yy_pl.basketData=!0),"pageData"===_yy_pl.type&&(db=_gtm.debouncer(firePageLoadEvent,/(p(l|d)p|checkout)/.test(host)?350:1)),void 0===_yy_pl[_yy_pl.type]||"renderedContentOp"==e.bertieType&&"string"==typeof e.ref&&/algorithmic\.impression/i.test(e.ref)&&/\/products?\/\w+/i.test(path)||(_yy_pl[_yy_pl.type]=!0,(rcTout=/home|checkout:recs|checkout:hyf|plp|pdp|orders:detail|phones:buylists/i.test(host)&&_yy_pl.pageData&&(_yy_pl.platformData||_yy_pl.siteData)&&_yy_pl.customerData&&(_yy_pl.basketData||_yy_pl.UIEventBasket)&&!_yy_pl.renderedContentOp?setTimeout(function(){resetMainFlags(),firePageLoadEvent("pageLoad",!0)},4e3):rcTout)&&"renderedContentOp"===_yy_pl.type&&(clearTimeout(rcTout),rcTout=0),(/bloks:(zones|home)|payment|phones:home|phones:pdp/i.test(host)||/checkout:conf/i.test(host)&&/ait_dev/.test(document.cookie))&&_yy_pl.pageData&&_yy_pl.platformData&&_yy_pl.customerData&&(resetMainFlags(),db("pageLoad")),/orders:list|slots|fav|zone|checkout:(phones:)?osum/i.test(host)&&_yy_pl.pageData&&(_yy_pl.platformData||_yy_pl.siteData)&&_yy_pl.customerData&&(_yy_pl.basketData||_yy_pl.UIEventBasket)?(resetMainFlags(),db("pageLoad")):/trolley/i.test(host)&&_yy_pl.pageData&&(_yy_pl.platformData||_yy_pl.siteData)&&_yy_pl.customerData&&(_yy_pl.basketData||_yy_pl.UIEventBasket)&&_yy_pl.trolleyData?(resetMainFlags(),_yy_pl.trolleyData=!1,db("pageLoad")):/home|checkout:recs|checkout:hyf|plp|pdp|orders:detail|phones:buylists/i.test(host)&&_yy_pl.pageData&&(_yy_pl.platformData||_yy_pl.siteData)&&_yy_pl.customerData&&(_yy_pl.basketData||_yy_pl.UIEventBasket)&&_yy_pl.renderedContentOp?(resetMainFlags(),_yy_pl.renderedContentOp=!1,db("pageLoad")):"checkout:conf"===host&&_yy_pl.pageData&&(_yy_pl.platformData||_yy_pl.siteData)&&_yy_pl.customerData&&_yy_pl.orderData&&(resetMainFlags(),_yy_pl.trolleyData=_yy_pl.orderData=!1,db("pageLoad")))})}(window),function(){function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],window.gtag=gtag;var gtagIDAdv,country=gtmDataLayer&&"function"==typeof gtmDataLayer.get("dLPlatformFuncs").countryAA&&gtmDataLayer.get("dLPlatformFuncs").countryAA()||gtmDataLayer.get("country")||gtmDataLayer.get("platformData.country"),isDebugMode=gtmDataLayer.get("dLGlobalFuncs.isDebugMode")(),env=gtmDataLayer&&gtmDataLayer.get("env")&&gtmDataLayer.get("env").match(/pro?d/i)&&!isDebugMode?"prod":"staging",gtagID=(gtagIDAdv="object"==typeof google_tag_manager["GTM-P9BVK4M"]&&"UK"==country?["DC-5035317","DC-4906386"]:"object"==typeof google_tag_manager["GTM-536P6G9"]&&"UK"==country?["AW-105285189"]:"object"==typeof google_tag_manager["GTM-5VTTD92"]?{UK:["DC-5118014","DC-4906386"],IE:["DC-11055621"],HU:["AW-859683922"],SK:["AW-968997721"],CZ:["AW-967628968"]}[country]||[]:{UK:["DC-11155204","DC-4906386","DC-5118014","DC-11155204","AW-951203243","AW-943890977"],IE:["AW-663348058"],HU:["DC-9462747","AW-859683922"],SK:["AW-968997721"],CZ:["AW-967628968"]}[country]||[],{staging:{UK:"G-DJR96F5CBD",IE:"G-JSDW3ZM9WG",HU:"G-1L9FPNT7J9",SK:"G-N7FZ32E8YG",CZ:"G-BTXPWS55HH"},prod:{UK:"G-33B19D36CY",IE:"G-YVXWF6D2Q3",HU:"G-SMN6XWLPM9",SK:"G-49RN63ZG8P",CZ:"G-EZ1BJ05B45"}}[env][country]||"G-DJR96F5CBD"),env=document.createElement("script");env.onload=function gtagLoadedCallback(){gtag("consent","default","UK"==country?{ad_storage:advCookieTrue?"granted":"denied",analytics_storage:expCookieTrue?"granted":"denied"}:{ad_storage:advCookieTrue?"granted":"denied",ad_user_data:advCookieTrue?"granted":"denied",ad_personalization:advCookieTrue?"granted":"denied",analytics_storage:expCookieTrue?"granted":"denied"});advCookieTrue||gtag("set","ads_data_redaction",!0);expCookieTrue&&advCookieTrue||gtag("set","url_passthrough",!0);0<gtagIDAdv.length&&advCookieTrue&&"UK"!=country&&gtagIDAdv.forEach(function(advID){gtag("config",advID)});gtagID&&gtag("config",gtagID,{traffic_type:isDebugMode?"internal":"production",send_page_view:!1});gtmDataLayer&&gtmDataLayer.set&&gtmDataLayer.set("gtagConfigSet","true");_gtm&&_gtm.triggerCustomEvent&&_gtm.triggerCustomEvent("gtagConfigSet")},env.async=!0,env.src="https://www.googletagmanager.com/gtag/js?id="+gtagID,document.head.appendChild(env),gtag("js",new Date)}(),function(){var marketingInteractionsObj=gtmDataLayer.get("marketingInteractions")||{};marketingInteractionsObj.gaBasketAdd=function(){if((!cookieBannerAvailable||expCookieTrue)&&"undefined"!=typeof ga&&"function"==typeof ga){var trackerID=function getTrackerID(){var country=gtmDataLayer.get("country")||"",iGHSDomain=/CZ|SK|HU/i.test(country);country=/UK|IE/i.test(country)?"ukLego":iGHSDomain?"iLego":null;return country}(),productArray=gtmDataLayer.get("basketOp.prodArray")||"";if(productArray&&productArray.length)for(var i=0;i<productArray.length;i++){var items=productArray[i],prodPrice=items.totalPriceChange&&items.totalPriceChange.price?items.totalPriceChange.price:0;ga(trackerID+".ec:addProduct",{id:items.tpnb,price:prodPrice/items.qtyChange,quantity:items.qtyChange})}ga(trackerID+".ec:setAction","add"),ga(trackerID+".send","event","basket actions","add","id")}_gtm.notify("GTM: GA Basket Adds fired")},gtmDataLayer.set("marketingInteractions",marketingInteractionsObj)}(),function(){var marketingInteractionsObj=gtmDataLayer.get("marketingInteractions")||{},country=gtmDataLayer.get("country")||gtmDataLayer.get("platformData.country");marketingInteractionsObj.doubleClickBasketAdd=function(){var basketData=gtmDataLayer.get("basketOp"),interactionType=basketData&&basketData.interactionType?basketData.interactionType:"",prodIds=basketData&&basketData.productIds?basketData.productIds:[];"UK"===country&&interactionType&&"function"==typeof gtag&&interactionType.match(/add/i)&&(gtmDataLayer.get("gtagConfigSet")?gtag("event","conversion",{allow_custom_scripts:!0,u1:"[BU]",u10:"[PostcodeStore ID]",u11:"[Delivery Date]",u12:"[Delivery TimeSlot]",u13:"[Coupon Cost]",u14:"[Shipping Cost]",u15:"[Amends]",u16:"[User Type (FirstTimeShopper)]",u17:"[Product Category]",u18:"[Product Sub Category]",u19:"[Number of Shops]",u2:"[UUID]",u20:"[Lego ID]",u21:"[GA ID]",u22:"[Platform Type]",u23:"[Amend Difference – Positive]",u24:"[Amend Difference – Negative]",u25:"[App User]",u3:"[AUID]",u4:"[Top Category]",u5:"[Product]",u6:prodIds,u7:"[Price]",u8:"[Quantity]",u9:"[Delivery Type]",send_to:"DC-4906386/tescoclu/tbasket+unique"}):window.addEventListener("gtagConfigSet",function(){gtag("event","conversion",{allow_custom_scripts:!0,u1:"[BU]",u10:"[PostcodeStore ID]",u11:"[Delivery Date]",u12:"[Delivery TimeSlot]",u13:"[Coupon Cost]",u14:"[Shipping Cost]",u15:"[Amends]",u16:"[User Type (FirstTimeShopper)]",u17:"[Product Category]",u18:"[Product Sub Category]",u19:"[Number of Shops]",u2:"[UUID]",u20:"[Lego ID]",u21:"[GA ID]",u22:"[Platform Type]",u23:"[Amend Difference – Positive]",u24:"[Amend Difference – Negative]",u25:"[App User]",u3:"[AUID]",u4:"[Top Category]",u5:"[Product]",u6:prodIds,u7:"[Price]",u8:"[Quantity]",u9:"[Delivery Type]",send_to:"DC-4906386/tescoclu/tbasket+unique"})}))},gtmDataLayer.set("marketingInteractions",marketingInteractionsObj)}(),function(){var country,siteApplication=gtmDataLayer.get("env")||gtmDataLayer.get("platformData.application"),marketingInteractionsObj=gtmDataLayer.get("marketingInteractions")||{};/pro?d/i.test(siteApplication)&&(country=gtmDataLayer.get("country")||gtmDataLayer.get("platformData.country"),marketingInteractionsObj.facebookBasketAdd=function(){var currencyCode,interactionType,prodIds,basketOp,prodPrice,payload,ukContentString;cookieBannerAvailable&&!advCookieTrue||(currencyCode=gtmDataLayer.get("dLPlatformFuncs").currencyCode(),interactionType=(basketOp=gtmDataLayer.get("basketOp"))&&basketOp.interactionType?basketOp.interactionType:"",prodIds=basketOp&&basketOp.productIds?basketOp.productIds:[],basketOp=basketOp&&basketOp.prodArray?basketOp.prodArray:[],prodPrice=0,payload={},ukContentString=[],basketOp.length&&basketOp.forEach(function(item){ukContentString.push({id:item.tpnb,quantity:item.qtyChange}),item.totalPriceChange&&(prodPrice+=item.totalPriceChange.price)}),payload=country.match(/UK/i)?{contents:ukContentString,content_type:"product",value:prodPrice.toFixed(2),currency:currencyCode}:{content_ids:prodIds,content_type:"product",value:prodPrice.toFixed(2),currency:currencyCode},interactionType&&"function"==typeof fbq&&/add/i.test(interactionType)&&(gtmDataLayer.get("fbLoaded")?fbq("track","AddToCart",payload):window.addEventListener("fbLoaded",function(){fbq("track","AddToCart",payload)})),_gtm.notify("GTM: Facebook Basket Adds fired"))}),gtmDataLayer.set("marketingInteractions",marketingInteractionsObj)}(),function(){var marketingInteractionsObj=gtmDataLayer.get("marketingInteractions")||{},globalFunctions=gtmDataLayer.get("dLPlatformFuncs")||{},country=gtmDataLayer.get("country")||gtmDataLayer.get("platformData.country"),siteCurrency=globalFunctions.currencyCode(),pageTitle=gtmDataLayer.get("pageData.pageTitle"),pageURL=gtmDataLayer.get("pageData.pageURL"),pageName=gtmDataLayer.get("pageData.v72"),pageType=gtmDataLayer.get("pageData.pageType"),amendMode="amend"==gtmDataLayer.get("customerData.amendMode")?"amending":"normal",purchaseId=gtmDataLayer.get("basicOp.contextValue"),gaItem=[],totalPriceFinal=0;function updatePageData(){pageTitle=gtmDataLayer.get("pageData.pageTitle"),pageURL=window.location.protocol+"//"+window.location.hostname+window.location.pathname,pageName=gtmDataLayer.get("pageData.v72"),pageType=gtmDataLayer.get("pageData.pageType"),amendMode="amend"==gtmDataLayer.get("customerData.amendMode")?"amending":"normal",purchaseId=gtmDataLayer.get("basicOp.contextValue")}function getProductData(){var productArray=gtmDataLayer.get("basketOp.prodArray")||[];gaItem=[],totalPriceFinal=0,productArray&&productArray.length&&productArray.forEach(function(item){var prodId=item.tpnb||null,prodPrice=item.totalPriceChange&&item.totalPriceChange.price?Math.abs(item.totalPriceChange.price):0,prodQty=Math.abs(item.qtyChange)||1,prodId={item_id:prodId,price:(prodPrice/prodQty).toFixed(2),quantity:prodQty,currency:siteCurrency};item.offer&&0<item.offer.length&&(prodId.item_category="clubcard offer"),gaItem.push(prodId),totalPriceFinal+=prodPrice})}function sendGtagEvent(type,payload){gtag("event",type,payload)}marketingInteractionsObj.ga4BasketAdd=function(){cookieBannerAvailable&&!expCookieTrue&&!/UK/i.test(country)||(updatePageData(),getProductData(),gtmDataLayer.get("gtagConfigSet")?(sendGtagEvent("add_to_cart",{page_title:pageTitle,page_location:pageURL,page_name:pageName,page_type:pageType,currency:siteCurrency,value:totalPriceFinal.toFixed(2),amend_mode:amendMode,items:gaItem}),gaItem=[]):window.addEventListener("gtagConfigSet",function(){sendGtagEvent("add_to_cart",{page_title:pageTitle,page_location:pageURL,page_name:pageName,page_type:pageType,currency:siteCurrency,value:totalPriceFinal.toFixed(2),amend_mode:amendMode,items:gaItem}),gaItem=[]}))},marketingInteractionsObj.ga4BasketRemove=function(){cookieBannerAvailable&&!expCookieTrue&&!/UK/i.test(country)||(updatePageData(),getProductData(),gtmDataLayer.get("gtagConfigSet")?(sendGtagEvent("remove_from_cart",{page_title:pageTitle,page_location:pageURL,page_name:pageName,page_type:pageType,currency:siteCurrency,value:totalPriceFinal.toFixed(2),amend_mode:amendMode,items:gaItem}),gaItem=[]):window.addEventListener("gtagConfigSet",function(){sendGtagEvent("remove_from_cart",{page_title:pageTitle,page_location:pageURL,page_name:pageName,page_type:pageType,currency:siteCurrency,value:totalPriceFinal.toFixed(2),amend_mode:amendMode,items:gaItem}),gaItem=[]}))},marketingInteractionsObj.ga4cancelledOrder=function(){function ga4UserCancelledOrder(){gtag("event","user_cancelled_order",{page_title:pageTitle,page_location:pageURL,page_name:pageName,page_type:pageType,amend_mode:amendMode,purchase_id:purchaseId})}cookieBannerAvailable&&!expCookieTrue&&!/UK/i.test(country)||(updatePageData(),gtmDataLayer.get("gtagConfigSet")?ga4UserCancelledOrder():window.addEventListener("gtagConfigSet",ga4UserCancelledOrder))},gtmDataLayer.set("marketingInteractions",marketingInteractionsObj)}(),function(){var marketingInteractionsObj=gtmDataLayer.get("marketingInteractions")||{};marketingInteractionsObj.googleAdwordsBasketAdd=function(){},gtmDataLayer.set("marketingInteractions",marketingInteractionsObj)}();
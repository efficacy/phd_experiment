!function(){function facebookPixels(){var n;if("prod"==(gtmDataLayer.get("env").match(/pro?d|live/)?"prod":"staging")){var country=gtmDataLayer.get("country")||gtmDataLayer.get("platformData.country"),authStatus=gtmDataLayer.get("customerData")&&gtmDataLayer.get("customerData.authenticatedLogin")?"logged in":"",shopperType=gtmDataLayer.get("customerData")&&gtmDataLayer.get("customerData.customerLoyaltyType")?gtmDataLayer.get("customerData.customerLoyaltyType"):"";if(!document.getElementById("fbmscr")){f=window,b=document,e="script",f.fbq||(n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)},f._fbq||(f._fbq=n),(n.push=n).loaded=!0,n.version="2.0",n.queue=[],(f=b.createElement(e)).async=!0,f.src="https://connect.facebook.net/en_US/fbevents.js",b=b.getElementsByTagName(e)[0],f.id="fbmscr",b.parentNode.insertBefore(f,b));for(var pixelIDList={HU:["2011219315796774"],SK:["606848083022513"],CZ:["178726922754452"],UK:["1648591638712092","2376396922605677"],IE:["672719947217480"]},x=0;x<pixelIDList[country].length;x++){var pixelID=pixelIDList[country][x]||"";fbq("set","autoConfig",!1,pixelID),fbq("init",pixelID)}gtmDataLayer.set("fbLoaded","true"),_gtm&&_gtm.triggerCustomEvent&&_gtm.triggerCustomEvent("fbLoaded")}var e=gtmDataLayer.get("pageData.busPreservedReferrer"),f={},b=(country.match(/UK/i)&&"logged in"==authStatus&&e?f={first_time_shopper:shopperType,referrer:e}:country.match(/UK/i)&&"logged in"==authStatus&&!e?f={first_time_shopper:shopperType}:e&&(f={referrer:e}),f!=={}?fbq("track","PageView",f):fbq("track","PageView"),window.location.pathname),authStatus=/^\/groceries\/([a-zA-Z]{2})-([a-zA-Z]{2})\/products\/.*/.test(b),shopperType=gtmDataLayer.get("dLPlatformFuncs").currencyCode(),productIDs=gtmDataLayer.get("renderedContentOp.gaPdpProdId");authStatus&&fbq("track","ViewContent",{content_ids:[productIDs],content_type:"product",content_category:gtmDataLayer.get("pageData.department"),content_name:gtmDataLayer.get("pageData.pageTitle"),currency:shopperType}),_gtm.notify("GTM: Facebook Pixels fired")}}gtmDataLayer.get("pageLoad")&&facebookPixels(),document.addEventListener("pageLoad",facebookPixels)}();